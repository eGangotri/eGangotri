//Download from https://chromedriver.chromium.org/downloads
//applicationDefaultJvmArgs = ["-Dwebdriver.chrome.driver=${System.getProperty('user.home')}${File.separator}eGangotri${File.separator}chromedriver${File.separator}chromedriver.exe"]
applicationDefaultJvmArgs = ["-Dwebdriver.chrome.driver=resources${File.separator}chromedriver.exe"]

task startMongoServer(type: Exec) {
    doFirst {
        println "startMongoServer"
        workingDir = file('bat_files/startMongoApiServer.bat')
        commandLine = ['cmd', '/C', 'start', 'startMongoApiServer.bat']
        // cmd /C start D:/Projects/WorkSpaces/WorldCleaner/devserver/start.bat
    }
}
//last upload failed so retry first thing,
ArrayList<String> uploadToArchiveArgs = ["TMP2"]//V_ANON, KANGRI, "KM"
//,"KRI_UR_DHARMA", "KRI_UR"  "SR_VIMAL", "EGB_ASI" ,"EG_URDU
// "JNGM_MANU","SALIM","MB", "SV_SHASTRI", "KANGRI", "MUTHU"
// "JNGM" ,  "JNGM_TEL", "JNGM_K", "JNGM_M", "JNGM_BEN", "EGM"*/]
def FOLDER_TO_GENERATE_SNAP2HTML_OF = "D:\\_Treasures69"
task uploadToArchive(dependsOn: [/*'snap2htmlCronJob',*/ 'refreshFocusLogFiles'], type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    mainClass = "com.egangotri.upload.archive.UploadToArchive"
    jvmArgs = applicationDefaultJvmArgs
    /** For Single Profile args = ["PRFL1"] For Multiple Profiles args The Following are the files that will be uploaded= ["PRFL1","PRFL2"]  */
    // "KRI_UR_DHARMA", "KRI_UR","VN1", "VN2", "JNGM"
    args = [*uploadToArchiveArgs]
}

//works
task uploadToArchiveSelective(dependsOn: [/*'snap2htmlCronJob',*/ 'refreshFocusLogFiles'], type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    mainClass = "com.egangotri.upload.archive.uploaders.UploadToArchiveSelective"
    jvmArgs = applicationDefaultJvmArgs
    /** For Single Profile args = ["PRFL1"] For Multiple Profiles args The Following are the files that will be uploaded= ["PRFL1","PRFL2"]  */
    // "KRI_UR_DHARMA", "KRI_UR","VN1", "VN2", "JNGM"
    args = ["FIP", "D:\\FIP\\IFP Quote Index (set of cards)\\Quote_Index - FIP EFEO Pondicherry2.pdf , D:\\FIP\\IFP Quote Index (set of cards)\\Quote_Index - FIP EFEO Pondicherry.pdf"]

}

task uploadToArchiveExcel(dependsOn: [/*'snap2htmlCronJob',*/ 'refreshFocusLogFiles'], type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    mainClass = "com.egangotri.upload.archive.uploaders.UploadToArchiveViaExcel"
    jvmArgs = applicationDefaultJvmArgs
    /** For Single Profile args = ["PRFL1"] For Multiple Profiles args The Following are the files that will be uploaded= ["PRFL1","PRFL2"]  */
    // "KRI_UR_DHARMA", "KRI_UR","VN1", "VN2", "JNGM"
    args = ["FIP", "D:\\FIP\\_IFP\\_IFP\\fip-uploadables-02-May-2024-15-46-(228)(8475).xlsx", "501-1000"]
}

task validateLinksAndReUploadBroken(dependsOn: 'classes', type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    mainClass = "com.egangotri.upload.archive.ValidateUploadsAndReUploadFailedItems"
    jvmArgs = applicationDefaultJvmArgs
    //by default last upload is picked. if you want to pick something previous, then specify
    // files below queued and usered order
    //args = ["queued_items_28-Apr-2023_6-27-AM", "ushered_items_28-Apr-2023_6-27-AM" ]
    args = []
}

task copyPostValidationFoldersToQueueAndUsheredFoldersAndStartReuploadProcess(dependsOn: 'classes', type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    mainClass = "com.egangotri.upload.archive.CopyPostValidationFoldersToQueuedAndUsheredFolders"
    jvmArgs = applicationDefaultJvmArgs
    args = []
}

task preUploadReview(dependsOn: 'classes', type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    mainClass = "com.egangotri.upload.archive.PreUploadReview"
    jvmArgs = applicationDefaultJvmArgs
    args = ["PRFL1", "PRFL2", "PRFL3", "PRFL4", "PRFL5"]
}

task reuploadUsingLinks(dependsOn: 'classes', type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    mainClass = "com.egangotri.upload.archive.ReuploadUsingLinks"
    jvmArgs = applicationDefaultJvmArgs
    args = []
}
/*
   https://www.windowscentral.com/how-create-and-run-batch-file-windows-10
 View: Running batch files on startup
 Windows-R shell:script. paste shortcutt your batch will ensure code will run after every restart
*/
task cronJob(dependsOn: 'classes', type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    mainClass = "com.egangotri.scheduler.RemoteJobScheduler"
    jvmArgs = applicationDefaultJvmArgs
    args = []
}

task snap2htmlCronJob(dependsOn: 'classes', type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    mainClass = "com.egangotri.batch.SnapToHtml"
    jvmArgs = applicationDefaultJvmArgs
    args = [FOLDER_TO_GENERATE_SNAP2HTML_OF]
}